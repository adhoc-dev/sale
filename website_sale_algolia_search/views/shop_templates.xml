<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="search_box" name="Algolia Autocomplete Search box" inherit_id="website.website_search_box">

        <xpath expr="//input[@name='search']" position="after">
            <style>
                .algolia-autocomplete {
                    width: 100%;
                }
                .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
                    width: 100%;
                }
                .algolia-autocomplete .aa-hint {
                    color: #999;
                }
                .algolia-autocomplete .aa-dropdown-menu {
                    width: 100%;
                    background-color: #fff;
                    border: 1px solid #999;
                    border-top: none;
                }
                .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
                    cursor: pointer;
                    padding: 5px 4px;
                }
                .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
                    background-color: #B2D7FF;
                }
                .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
                    font-weight: bold;
                    font-style: normal;
                }
            </style>
            <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
            <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
            <script>
                // TODO hacer parametrizable app id, apy keys, resultname, suggestion y url
                var client = algoliasearch('COMPLETAR app id', 'COMPLETAR search only apy keys');
                var index = client.initIndex('COMPLETAR index');
                autocomplete('input.search-query.form-control.oe_search_box', { hint: false, minLength: 7 }, [
                    {
                    source: autocomplete.sources.hits(index, { hitsPerPage: 5, facetFilters: 'website_published: True'}),
                    displayKey: 'name',
                    templates: {
                        suggestion: function(suggestion) {
                        return '<span>' + suggestion._highlightResult.name.value + '</span>'
                        }
                    }
                    }
                ]).on('autocomplete:selected', function(event, suggestion, dataset, context) {
                    window.location.href = suggestion.website_url;
                });
            </script>
        </xpath>
    </template>

</odoo>
