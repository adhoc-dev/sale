<odoo>

    <record id="view_account_exchange_diff_invoice_form" model="ir.ui.view">
         <field name="name">account.exchange_diff_invoice</field>
         <field name="model">account.exchange_diff_invoice</field>
         <field name="arch" type="xml">
            <form>
                <field name="exchange_diff_amount" invisible="1"/>
                <field name="company_id" invisible="1"/>
                <field name="company_currency_id" invisible="1"/>
                <notebook>
                <page string="Imputaciones para ajustar" attrs="{'invisible': [('line_ids', '=', [])]}">
                <field name="line_ids">
                    <tree editable="top" create="0">
                        <field name="partial_line_id" force_save="1" invisible="1" string="Fecha Factura"/>
                        <field name="debit_date" force_save="1" string="Fecha Factura"/>
                        <field name="debit_name" force_save="1" string="Número Factura"/>
                        <field name="credit_date_maturity" force_save="1" string="Fecha pago" help="Se considera fecha de vencimiento del pago"/>
                        <field name="credit_name" force_save="1" string="Comprobante de Pago"/>
                        <field name="reconciled_amount" force_save="1" string="Importe Imputado" help="Importe del pago imputado a la factura" sum="Total"/>
                        <field name="debit_rate" force_save="1" string="Tasa Factura" help="Tasa de cambio de factura"/>
                        <field name="credit_rate" force_save="1" string="Tasa Pago" help="Tasa de cambio a la fecha del pago. En caso de fechas a futuro va a ser la última cotización encontrada"/>
                        <field name="variation_perc"/>
                        <field name="exchange_diff_amount" force_save="1" sum="Total"/>
                        <field name="company_currency_id" force_save="1" invisible="1"/>
                    </tree>
                </field>
                </page>
                <page string="NC/ND a validar" attrs="{'invisible': [('invoice_ids', '=', [])]}">
                <field name="invoice_ids" attrs="{'invisible': [('invoice_ids', '=', [])]}" context="{'tree_view_ref': 'account_multicurrency_ux.nc_nd_invoice_tree', 'form_view_ref': 'account.invoice_form'}"/>
                </page>
                </notebook>
                <footer>
                    <button name="confirm" string="Crear NC" type="object" class="oe_highlight" attrs="{'invisible': [('exchange_diff_amount', '&gt;=', 0)]}"/>
                    <button name="confirm" string="Crear ND" type="object" class="oe_highlight" attrs="{'invisible': [('exchange_diff_amount', '&lt;=', 0)]}"/>
                    <span attrs="{'invisible': [('exchange_diff_amount', '=', 0)]}"> or </span>
                    <button name="ignore" string="Ignorar" type="object" help="Ignorar creación de NC/ND para estas facturas" groups="account.group_account_user" confirm="Se van a marcar todas las facturas para que NO requieran NC/ND de ajuste. Desea continuar?"/>
                    <span groups="account.group_account_user"> or </span>
                    <button string="Cancel" class="oe_link" special="cancel"/>
                </footer>
            </form>
         </field>
     </record>

    <record id="action_account_exchange_diff_invoice" model="ir.actions.act_window">
        <field name="name">Asistente para ajuste por diferencia de cambio</field>
        <field name="res_model">account.exchange_diff_invoice</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="account.model_account_move"/>
    </record>

</odoo>
